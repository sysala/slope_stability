# AGMG vs HYPRE BoomerAMG Comparison

## Problem

Benchmark based on:

- `slope_stability/slope_stability_3D_hetero_seepage_SSR_benchmarking.m`
- Mesh: `meshes/slope_with_waterlevels_concave.h5`
- Method: indirect continuation SSR (`direct_on = 0`, `indirect_on = 1`)
- Continuation settings:
  - `lambda_init = 0.7`
  - `d_lambda_init = 0.1`
  - `d_lambda_min = 1e-5`
  - `d_lambda_diff_scaled_min = 0.005`
  - `omega_max_stop = 7e7`
  - `step_max = 100`
- Newton settings:
  - `it_newt_max = 50`
  - `it_damp_max = 10`
  - `tol = 1e-4`
  - `r_min = 1e-4`

Compared linear solvers:

- `DFGMRES_AGMG`
- `DFGMRES_HYPRE_BOOMERAMG` (OpenMP threads = 16)

## Exported Benchmark Data

Generated by the benchmark script into:

- `slope_stability/test_solver_elasticity/hetero_seepage_ssr_benchmark/summary.csv`
- `slope_stability/test_solver_elasticity/hetero_seepage_ssr_benchmark/dfgmres_agmg_indirect_steps.csv`
- `slope_stability/test_solver_elasticity/hetero_seepage_ssr_benchmark/dfgmres_hypre_boomeramg_indirect_steps.csv`
- `slope_stability/test_solver_elasticity/hetero_seepage_ssr_benchmark/dfgmres_agmg_indirect_attempts.csv`
- `slope_stability/test_solver_elasticity/hetero_seepage_ssr_benchmark/dfgmres_hypre_boomeramg_indirect_attempts.csv`
- `slope_stability/test_solver_elasticity/hetero_seepage_ssr_benchmark/benchmark_results.mat`

The per-step CSVs contain continuation-step timing and linear-iteration export:

- `lambda`, `omega`, `u_max`
- `step_wall_time_s`
- `newton_iterations`, `newton_iterations_total_attempts`, `newton_relres_end`
- `linear_iterations`
- `linear_solve_time_s`, `linear_preconditioner_time_s`, `linear_orthogonalization_time_s`

## Summary (from `summary.csv`)

| Metric | DFGMRES_AGMG | DFGMRES_HYPRE_BOOMERAMG |
|---|---:|---:|
| Continuation Steps | 35 | 35 |
| Final Lambda | 1.448165 | 1.448180 |
| Final Omega | 2.500251e+07 | 2.500350e+07 |
| Final Umax | 525.006506 | 524.971217 |
| Newton Iters Total | 337 | 332 |
| Linear Iters Total | 7338 | 2638 |
| Linear Prec [s] | 143.452996 | 121.534620 |
| Linear Solve [s] | 423.709079 | 244.406418 |
| Linear Ortho [s] | 242.974350 | 218.892540 |
| Continuation Wall [s] | 1934.833381 | 1705.826967 |

## Derived Comparison

- Continuation wall-time speedup (HYPRE vs AGMG): `1.134x` (about `13.4%` faster)
- Linear iterations reduction: `64.05%` fewer iterations (`7338 -> 2638`)
- Newton iterations: slightly lower with HYPRE (`337 -> 332`)
- Final SSR state is practically identical:
  - AGMG: `lambda = 1.448165`, `omega = 2.500251e+07`, `Umax = 525.0065`
  - HYPRE: `lambda = 1.448180`, `omega = 2.500350e+07`, `Umax = 524.9712`

## Continuation/Convergence Notes

- Both runs terminated with: `Minimal increase of lambda was achieved.`
- Last converged continuation step in both runs: `step 35`
- Last-step nonlinear difficulty (still accepted by stopping logic):
  - AGMG: `newton_iterations = 47`
  - HYPRE: `newton_iterations = 45`

## Selected Per-Step Extremes

Using steps `3..35` from the exported step CSVs:

- AGMG:
  - mean step wall time: `57.722 s`
  - mean linear iterations per step: `221.152`
  - mean Newton iterations per step: `9.909`
  - Newton relres range (excluding NaN final row): `[1.124e-05, 9.785e-05]`
- HYPRE:
  - mean step wall time: `50.817 s`
  - mean linear iterations per step: `79.303`
  - mean Newton iterations per step: `9.758`
  - Newton relres range (excluding NaN final row): `[7.763e-06, 9.980e-05]`
